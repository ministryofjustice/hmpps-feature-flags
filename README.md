# HMPPS Feature Flags

An instance of [Flipt](https://www.flipt.io/), for controlling feature flags for use by HMPPS teams within their projects.

We have three instances corresponding to environments
[DEV](https://feature-toggles-dev.hmpps.service.justice.gov.uk/)
[PREPROD](https://feature-toggles-preprod.hmpps.service.justice.gov.uk/)
[PROD](https://feature-toggles.hmpps.service.justice.gov.uk/)

Documentation from flipt.io [docs](https://docs.flipt.io/introduction)

## Pre-requisites for usage at HMPPS

- github account member of MOJ org

### Getting started

When onboarding your team, ensure that you either have a namespace for the team or you will need to create one.
The namespace should take the form of your team name, eg. 'ManageAWorkforce'
The namespace should be created/exist in all environments
All the artifacts you create for your team's use should be stored under this namespace.
You should next generate an api-token, for your namespace, in each of the environments (this will be used for flag evaluation)
It is suggested that the secrets are named as below for consistency

`kubectl create secret generic pic-flipt \
--from-literal=URL=<url of toggle service for the corresponding environment>  \
--from-literal=API_KEY=<api key generated by the toggle service> \
-n <your kubernetes namespace>`

With the namespace created, you are good to create your artifacts (flags, segments etc)
When using the flipt web interface, ensure you have the correct namespace selected (top left corner)

### Feature flag evaluation

There are SDKs available on the flipt.io site,
- [flipt-client-sdks](https://github.com/flipt-io/flipt-client-sdks) Client evaluation includes caching
- [flipt-server-sdks](https://github.com/flipt-io/flipt-server-sdks) Server evaluation maybe faster

